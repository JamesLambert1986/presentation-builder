{"version":3,"file":"applied-filters.component.min.js","sources":["../../modules/applied-filters.js","applied-filters.component.js"],"sourcesContent":["// @ts-nocheck\nfunction createAppliedFilters(container, filters) {\n    function addFilterButton(filters, input) {\n        let shouldRemoveFilter = false;\n        let inputName = input.getAttribute('name');\n        if (inputName.includes('[]'))\n            inputName = inputName.replace('[]', `[${input.value}]`);\n        let filter = filters.querySelector(`[data-name=\"${inputName}\"]`);\n        if (filter && input.getAttribute('type') == 'checkbox')\n            shouldRemoveFilter = !input.checked ? true : false;\n        let filterText = input.getAttribute('data-filter-text');\n        if (!filter) {\n            filter = document.createElement('button');\n            filters.appendChild(filter);\n        }\n        filter.setAttribute('type', 'button');\n        filter.classList.add('filter');\n        filter.setAttribute('data-name', inputName);\n        filter.innerHTML = filterText.replace('$value', input.value);\n        // If the value\n        if (!input.value || shouldRemoveFilter)\n            filter.remove();\n        // If input has an ancestor with data-filter and all of inputs in that parent have been filled in then we need to transform the filter\n        if (input.parentNode.closest('[data-filter-text]')) {\n            let parent = input.parentNode.closest('[data-filter-text]');\n            let allValuesSet = true;\n            inputName = \"\";\n            parent.querySelectorAll('input').forEach((element, index) => {\n                let name = element.getAttribute('name');\n                // create a joined inputname for the parent filter\n                inputName += `${index != 0 ? ',' : ''}${name}`;\n                if (filters.querySelector(`[data-name=\"${name}\"]`))\n                    filters.querySelector(`[data-name=\"${name}\"]`).remove();\n                if (element.value) {\n                    let childFilter = document.createElement('button');\n                    childFilter.setAttribute('type', 'button');\n                    childFilter.classList.add('filter');\n                    childFilter.setAttribute('data-name', name);\n                    childFilter.innerHTML = filterText.replace('$value', element.value);\n                    filters.appendChild(childFilter);\n                }\n                else\n                    allValuesSet = false;\n            });\n            if (filters.querySelector(`[data-name=\"${inputName}\"]`))\n                filters.querySelector(`[data-name=\"${inputName}\"]`).remove();\n            if (allValuesSet) {\n                let newFilterText = parent.getAttribute('data-filter-text');\n                parent.querySelectorAll('input').forEach((element, index) => {\n                    let name = element.getAttribute('name');\n                    // Remove all the child filter tags\n                    if (filters.querySelector(`[data-name=\"${name}\"]`))\n                        filters.querySelector(`[data-name=\"${name}\"]`).remove();\n                    newFilterText = newFilterText.replace(`$${index + 1}`, element.value);\n                });\n                let parentFilter = document.createElement('button');\n                parentFilter.setAttribute('type', 'button');\n                parentFilter.classList.add('filter');\n                parentFilter.setAttribute('data-name', inputName);\n                parentFilter.innerHTML = newFilterText;\n                filters.appendChild(parentFilter);\n            }\n        }\n    }\n    // check for inputs on load\n    Array.from(container.querySelectorAll('input[type=\"checkbox\"]:checked')).forEach((input, index) => {\n        addFilterButton(filters, input);\n    });\n    // check for change in displayed inputs\n    Array.from(container.querySelectorAll('input[data-filter-text]')).forEach((input, index) => {\n        input.addEventListener('change', function (event) {\n            addFilterButton(filters, input);\n            event.stopPropagation(); // Don't allow the below event handler to trigger\n        });\n    });\n    // Some change event aren't getting triggered above so this event listener on the container will pick them up. This happens with input in modals\n    container.addEventListener('change', function (event) {\n        if (event && event.target instanceof HTMLElement && event.target.closest('input[data-filter-text]')) {\n            let input = event.target.closest('input[data-filter-text]');\n            addFilterButton(filters, input);\n        }\n    });\n    filters.addEventListener('click', function (event) {\n        if (event && event.target instanceof HTMLElement && event.target.closest('.filter')) {\n            let filter = event.target.closest('.filter');\n            let names = filter.getAttribute('data-name').split(',');\n            for (var t = 0; t < names.length; t++) {\n                let name = names[t];\n                let selector = `[name=\"${name}\"]`;\n                if (name.match(/\\[(.*)\\]/)) {\n                    let newName = name.replace(/\\[(.*)\\]/, `[]`);\n                    let value = name.replace(/.*\\[(.*)\\]/, `$1`);\n                    selector = `[value=\"${value}\"]`;\n                }\n                let inputs = container.querySelectorAll(selector);\n                for (var i = 0; i < inputs.length; i++) {\n                    let input = inputs[i];\n                    if (input.getAttribute('type') != 'radio' && input.getAttribute('type') != 'checkbox')\n                        input.value = \"\";\n                    else {\n                        input.checked = false;\n                        var event = new Event('force');\n                        if (!container.hasAttribute('data-nosubmit'))\n                            input.closest('form').dispatchEvent(event);\n                    }\n                }\n            }\n            filter.remove();\n        }\n    }, false);\n}\nexport default createAppliedFilters;\n","// @ts-nocheck\nimport createAppliedFilters from \"../../modules/applied-filters.js\";\n// Data layer Web component created\nwindow.dataLayer = window.dataLayer || [];\nwindow.dataLayer.push({\n    \"event\": \"customElementRegistered\",\n    \"element\": \"Applied Filters\"\n});\nclass iamAppliedFilters extends HTMLElement {\n    constructor() {\n        super();\n        this.attachShadow({ mode: 'open' });\n        const assetLocation = document.body.hasAttribute('data-assets-location') ? document.body.getAttribute('data-assets-location') : '/assets';\n        const coreCSS = document.body.hasAttribute('data-core-css') ? document.body.getAttribute('data-core-css') : `${assetLocation}/css/core.min.css`;\n        const loadCSS = `@import \"${assetLocation}/css/components/applied-filters.css\";`;\n        let classList = this.classList.toString();\n        const template = document.createElement('template');\n        template.innerHTML = `\r\n    <style>\r\n    @import \"${coreCSS}\";\r\n    ${loadCSS}\r\n    ${this.hasAttribute('css') ? `@import \"${this.getAttribute('css')}\";` : ``}\r\n    </style>\r\n    <div class=\"applied-filters ${classList}\"></div>\r\n    <slot></slot>\r\n    `;\n        this.shadowRoot.appendChild(template.content.cloneNode(true));\n    }\n    connectedCallback() {\n        createAppliedFilters(this, this.shadowRoot.querySelector('.applied-filters'));\n    }\n}\nexport default iamAppliedFilters;\n"],"names":["createAppliedFilters","container","filters","addFilterButton","input","shouldRemoveFilter","inputName","filter","filterText","parent","allValuesSet","element","index","name","childFilter","newFilterText","parentFilter","event","names","selector","inputs","i","iamAppliedFilters","assetLocation","coreCSS","classList","template"],"mappings":"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"}